<idea-plugin>
    <id>de.tecipe</id>
    <name>git-crypt</name>
    <version>XXXX</version>
    <vendor email="support@tecipe.de" url="http://www.tecipe.de">Tecipe</vendor>

    <description><![CDATA[
    <p>This Intellij IDEA Plugin makes life with git-crypt way better </p>
    <h2 id="how-to-use-it">How to use it</h2>
    <h3 id="prerequisite">Prerequisite</h3>
    <p>You need to install git-crypt on your system.</p>
    <h3 id="configure-git-crypt-program-path">Configure git-crypt program path</h3>
    <p>Click on the &#39;git-crypt&#39; widget in the toolbar at the bottom of Intellij.<br>In the popup menu that opens click on &#39;git-crypt configure program path&#39;
    to open the settings.<br>Now set the path to your git-crypt program location.</p>
    <p>You will also find the settings under <code>Preferences -&gt; Other Settings -&gt; git-crypt global</code></p>
    <h3 id="configure-git-crypt-key-path">Configure git-crypt key path</h3>
    <p>To lock/unlock your repo you will need to configure the correct key.<br>You can do that clicking on the &#39;git-crypt&#39; widget in the toolbar at the bottom of Intellij.<br>In the popup menu that opens click on &#39;git-crypt configure project key&#39;
    to open the project settings.<br>Now you can set the path to your git-crypt key location for the <strong>current project</strong>.<br>If you prefer to set the path globally you need to navigate to <code>Preferences -&gt; Other Settings -&gt; git-crypt global</code>
    and set the path to your key here.</p>
    <h3 id="features">Features</h3>
    <ul>
    <li>unlock</li>
    <li>lock</li>
    <li>force key</li>
    </ul>
    <h4 id="unlock-lock">Unlock/Lock</h4>
    <p>This should be self explanatory</p>
    <h4 id="force-key-fix-corrupted-encrypted-file">Force Key / Fix corrupted encrypted file</h4>
    <p>Unluckily Git-crypt has a bug where encrypted files get corrupted when unlocked with a wrong key. Now that the file has been changed you have local changes.<br>If you try to revert the wrong encrypted files you will get a filter-error because the key is also needed to reverse the correct file.<br>To solve this problem you have to set the correct key in the preferences and force the key into the .git directory with the <code>git-crypt force key</code> feature.<br>After that you can revert the process because now the right key is used for the filter.</p>
    ]]></description>


    <!-- please see http://www.jetbrains.org/intellij/sdk/docs/basics/getting_started/plugin_compatibility.html
         on how to target different products -->
    <!-- uncomment to enable plugin in all products
    <depends>com.intellij.modules.lang</depends>
    -->

    <extensions defaultExtensionNs="com.intellij">
        <applicationService
                serviceImplementation="de.tecipe.gitcrypt.ui.config.application.GitCryptApplicationSettings"/>
        <projectService serviceImplementation="de.tecipe.gitcrypt.ui.config.project.GitCryptProjectSettings"/>

        <applicationConfigurable
                instance="de.tecipe.gitcrypt.ui.config.application.GitCryptApplicationSettingsConfigurable"
                id="git-crypt.settings"/>

        <projectConfigurable instance="de.tecipe.gitcrypt.ui.config.project.GitCryptProjectSettingsConfigurable"
                             id="git-crypt-project.settings" nonDefaultProject="true"/>

        <statusBarWidgetFactory implementation="de.tecipe.gitcrypt.ui.GitCryptWidgetFactory"
                                id="de.tecipe.gitcrypt.ui.GitCryptWidgetFactory"
                                order="first"/>
    </extensions>
    <depends>com.intellij.modules.platform</depends>
    <depends>com.intellij.modules.vcs</depends>
    <depends>Git4Idea</depends>

    <actions>
        <group id="git-crypt.Unlock" text="git-crypt lock/unlock" description="Click to unlock">
            <add-to-group group-id="Git.Menu"/>
            <action class="de.tecipe.gitcrypt.GitCryptAction" id="git-crypt.Actions.Unlock"
                    text="git-crypt lock/unlock"/>
        </group>
        <group id="git-crypt.ForceKey" text="git-crypt force key"
               description="Click to force your key to the git-crypt settings, could help fixing your repository">
            <add-to-group group-id="Git.Menu"/>
            <action class="de.tecipe.gitcrypt.GitCryptForceKeyAction" id="git-crypt.Actions.ForceKey"
                    text="git-crypt force key"/>
        </group>
        <group id="git-crypt.AddFile" text="git-crypt add file" description="Click to handle file as encrypted file">
            <add-to-group group-id="Git.ContextMenu"/>
            <action class="de.tecipe.gitcrypt.GitCryptAddAction" id="git-crypt.Actions.AddFile"
                    text="git-crypt add file"/>
        </group>
    </actions>

</idea-plugin>
